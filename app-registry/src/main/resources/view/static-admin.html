<!DOCTYPE html>
<!--
  ~ Copyright. Tous droits réservés. WebServices pour l’Education.
  -->

<html>
<head>
	<title>{{#i18n}}directory.admin.title{{/i18n}}</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<script src="{{#infra}}js/loader.js{{/infra}}" type="text/javascript" id="context"></script>
	<script src="{{#static}}js/model.js{{/static}}" type="text/javascript"></script>
	<script src="{{#static}}js/controller.js{{/static}}" type="text/javascript"></script>
</head>
<body>
<admin-portal>
	<article ng-controller="AppRegistry">
		<nav class="side-tabs three cell">
			<ul>
				<li ng-class="{ selected: !application.id }" ng-click="newApplication()">
					<strong>Créer une application</strong>
				</li>
				<li ng-repeat="application in applications.all" ng-click="viewApplication(application)" ng-class="{ selected: $parent.application === application }">
					[[application.name]]
				</li>
			</ul>
		</nav>
		<article class="side-tabs-content nine cell" ng-if="application">
				<h1 class="nine cell">[[application.name]]</h1>
				<button class="right-magnet cell">Supprimer</button>

				<div class="row preview">
					<h2>Prévisualiser</h2>
					<iframe ng-src="[[previewPath(application)]]"></iframe>
				</div>
			<div class="row">
				<label class="cell"><span tooltip="tooltip.name">Nom</span></label>
				<input type="text" ng-model="application.name" class="cell" />
			</div>
				<div class="row">
					<label class="cell"><span tooltip="tooltip.displayName">Clef i18n</span></label>
					<input type="text" ng-model="application.displayName" complete-change="updatePath()" class="cell" />
				</div>
				<div class="row">
					<label class="cell"><span tooltip="tooltip.icon">Icône</span></label>
					<input type="text" ng-model="application.icon" complete-change="updatePath()" class="cell" />
				</div>
				<div class="row" ng-if="application.external">
					<label class="cell"><span tooltip="tooltip.password">Mot de passe</span></label>
					<input type="text" ng-model="application.password" class="cell" />
				</div>
				<div class="row">
					<label class="cell"><span tooltip="tooltip.url">URL</span></label>
					<input type="text" ng-model="application.url" complete-change="updatePath()" class="cell" />
				</div>

				<div class="row">
					<label class="cell"><span tooltip="tooltip.target">Cible</span></label>
					<select ng-model="application.target" ng-change="updatePath()" class="cell">
						<option value="">Portail</option>
						<option value="_blank">Nouvelle page</option>
						<option value="adapter">Adapateur</option>
					</select>
				</div>
				<div class="row" ng-if="application.external">
					<input type="checkbox" ng-model="application.transferSession" />
					<label class="four cell"><span tooltip="tooltip.transferSession">Transmettre la session</span></label>
				</div>
				<div class="row">
					<a ng-if="!display.advanced" ng-click="showAdvanced()" class="right-magnet">Paramètres avancés</a>
				</div>
				<div class="row" ng-if="display.advanced">
					<div class="row">
						<label class="cell">Scope</label><input class="cell" type="text" />
					</div>
					<div class="row" ng-id="!application.external">
						<label class="cell"><span tooltip="tooltip.password">Mot de passe</span></label>
						<input type="text" ng-model="application.password" class="cell" />
					</div>
					<div class="row">
						<label class="cell">Mode d'identification</label>
						<select>
							<option>Code</option>
							<option>Identifiants du client</option>
						</select>
					</div>
				</div>
				<div class="row">
					<a ng-if="display.advanced" ng-click="hideAdvanced()" class="right-magnet">Mode simple</a>
				</div>
			<h1>Gestion des rôles</h1>
			<div class="row">
				<button>Créer un rôle</button>
				<div ng-repeat="role in roles.applicationRoles(application)" class="accordion" ng-class="{ opened: role.selected }">
					<h2 ng-click="selectRole(role)">[[role.name]]</h2>
					<div class="twelve cell toggle">
						<div class="row content">
							<div class="row">
								<label class="cell">Nom du rôle</label>
								<input type="text" ng-model="role.name" />
							</div>

							<h3>Autorisations</h3>
							<ul class="selectable-list">
								<li ng-repeat="authorization in application.authorizations.all" ng-click="role.switch(authorization)" ng-class="{ selected: role.hasAuthorization(authorization) }">
									[[authorization.displayName]]
								</li>
							</ul>
						</div>

					</div>
				</div>
			</div>
		</article>
		<div class="clear"></div>
	</article>
	<div class="clear"></div>
</admin-portal>
</body>
</html>
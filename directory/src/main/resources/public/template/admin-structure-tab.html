<!--
    |||||||||||||||||||||||
    |||  STRUCTURE OPS  |||
    |||||||||||||||||||||||
-->

<!-- Structure selection menu -->
<div>
    <div ng-include="'structure-tree'"></div>
    <div class="three" style="position: relative;">
        <div class="vertical_buttons_container" style="right: -36px; top: 17px;">
            <!-- Creation button -->
            <button ng-click="setShowWhat('showStructureCreation'); initStructure()" tooltip="directory.tooltip.createStructure"
                    class="directory-list-glyph-button plus-icon">
            </button>
        </div>
    </div>
</div>

<article class="side-tabs-content nine cell" ng-if="structure || createdStructure">

    <!-- Structure details -->
    <div ng-if="structure && showWhat === 'showCurrentStructure'">
        <div class="row"><h1 style="margin-bottom: 0; text-align:center;">[[structure.name]]</h1></div>
        <hr class="separator">
        <div style="text-align:center">
            <button ng-click="structure.update()">[[lang.translate("directory.save")]]</button>
        </div>
        <hr class="separator">
        <div class="twelve cell"><strong class="four cell">[[lang.translate("directory.userId")]]</strong> [[structure.id]]</div>
        <div class="twelve cell">
            <strong class="four cell directory-top-padded">[[lang.translate("directory.name")]]</strong>
            <input class="eight cell" type="text" ng-model="structure.name"/>
        </div>
        <div class="twelve cell" ng-if="structure.parents">
            <strong class="four cell directory-top-padded">[[lang.translate("directory.structure.parents")]]</strong>
            <nav class="eight cell">
                <ul class="angle-list small" style="margin: 0">
                    <li ng-repeat="parent in structures.all | filter : filterOnlyParentStructures | orderBy: 'name'">[[parent.name]] <button class="right-magnet close" ng-click="structure.detachParent(parent, refreshScope)"></button></li>
                </ul>
            </nav>
        </div>
        <hr class="separator cell">
        <div class="twelve cell">
            <h3><i18n>directory.admin.attachChildStructures</i18n></h3>
            <nav class="vertical search-container-left three cell" style="height: 380px">
                <input type="text" placeholder="[[lang.translate('directory.search')]]" ng-model="filterStructures"/>
                <ul style="height: 320px; padding-top: 10; border-bottom: none; margin-bottom: 10px">
                    <li ng-repeat="potentialChild in structures.all | filter: filterExcludeCurrentStructure(filterStructures) | orderBy: 'name'"
                        ng-click="potentialChild.attachParent(structure, refreshScope)"
                        style="padding-left: 0">
                        <span>[[potentialChild.name]]</span>
                    </li>
                </ul>
            </nav>
            <div class="eight cell">
                <h5 style="text-align: center">[[lang.translate("directory.structure.children")]]</h5>
                <ul class="angle-list small" style="padding-left: 20px">
                    <li ng-repeat="child in structures.all | filter: filterOnlyChildStructures | orderBy: 'name'">
                        [[child.name]]
                        <button class="close right-magnet" ng-click="child.detachParent(structure, refreshScope)"></button>
                    </li>
                </ul>
            </div>
        </div>

    </div>

    <!-- Structure creation -->
    <div ng-if="showWhat === 'showStructureCreation'">
        <div class="row"><h1 style="margin-bottom: 0; text-align:center;">[[createdStructure.name ? createdStructure.name : lang.translate("directory.structure")]]</h1></div>
        <hr class="separator">
        <div style="text-align:center">
            <button ng-click="createdStructure.create(refreshStructures)">[[lang.translate("directory.admin.create")]]</button>
        </div>
        <hr class="separator">
        <div class="twelve cell">
            <strong class="four cell directory-top-padded">[[lang.translate("directory.name")]]</strong>
            <input class="eight cell" type="text" ng-model="createdStructure.name"/>
        </div>
    </div>

</article>

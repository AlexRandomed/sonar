(function(){var a=model.widgets.findWidget("birthday");a.classes=[];a.currentClass="";a.emptyList="";a.getDay=function(b){return moment(b).date()};a.getMonth=function(b){return moment(b).format("MMMM")};a.birthdaysInClass=function(){return _.filter(a.birthdays,function(b){return _.find(b.classes,function(c){return c[0]===a.currentClass.id})!==undefined})};a.saveDefaultClass=function(){http().get("/userbook/api/edit-userbook-info?prop=userPreferencesBirthdayClass&value="+a.currentClass.id)};http().get("/userbook/user-preferences").done(function(b){a.currentClass={id:b.result[0].userPreferencesBirthdayClass};http().get("/userbook/person/birthday").done(function(c){lang.addBundle("/directory/i18n",function(){a.emptyList=lang.translate("nobirthday");a.birthdays=_.filter(c,function(e){return moment(e.birthDate).month()===moment().month()});a.birthdays=a.birthdays.sort(function(f,e){return moment(f.birthDate).date()-moment(e.birthDate).date()});var d=[];d=_.pluck(a.birthdays,"classes");d.forEach(function(e){e.forEach(function(f){if(!_.findWhere(a.classes,{id:f[0]})){a.classes.push({name:f[1],id:f[0]})}})});a.currentClass=_.findWhere(a.classes,{id:a.currentClass.id});if(!a.currentClass){a.currentClass=a.classes[0]}model.widgets.apply()})})})}());
routes.define(function(a){a.when("/search",{action:"directory"}).when("/myClass",{action:"myClass"}).when("/user-view/:userId",{action:"viewUser"}).when("/:userId",{action:"viewUser"}).otherwise({redirectTo:"/myClass"})});function DirectoryController(b,c,a){b.users=[];b.lang=lang;b.search={text:"",field:"",maxLength:15,clear:function(){this.text="";this.field=""}};b.increaseSearchSize=function(){b.search.maxLength+=15;if(!b.$$phase){b.$apply("search")}};b.viewsContainers={};b.openView=function(e,f){b.search.maxLength=15;var g="/directory/public/template/";b.viewsContainers[f]=g+e+".html"};b.containsView=function(f,e){var g="/directory/public/template/";return b.viewsContainers[f]===g+e+".html"};b.openView("class","page");b.openView("user-infos","details");a({viewUser:function(e){new User({id:e.userId}).select();b.openView("profile","page");b.title="profile"},directory:function(){b.users=c.directory.users;b.openView("directory","page");b.viewsContainers.main="empty";b.title="directory"},myClass:function(){b.users=c.myClass.users;c.myClass.sync();b.openView("class","page");b.title="class"}});b.searchDirectory=function(){c.directory.users.all=[];c.directory.users.searchDirectory(b.search.field);b.openView("list-view","main")};b.selectFirstUser=function(){if(c.directory.users.length){b.selectUser(c.directory.users.first())}else{b.selectUser(c.myClass.users.first())}};b.deselectUser=function(){c.directory.users.current.deselect();c.myClass.users.current.deselect();b.openView("list-view","main")};b.selectUser=function(e){if(!b.$$phase){b.$apply("search")}if(b.containsView("main","user-selected")){ui.scrollToTop()}else{window.scrollTo(0,200)}c.directory.users.deselectAll();c.myClass.users.deselectAll();e.select();b.openView("user-selected","main")};var d={relative:"cyan",teacher:"green",student:"orange"};b.colorFromType=function(e){return d[e.toLowerCase()]};c.on("directory.users.change, myClass.users.change",function(f){if(!b.$$phase){b.$apply("users")}});b.openView("list-view","main")}function ClassAdmin(a,b){b.myClass.sync();b.on("myClass.users.change",function(){a.$apply("users")});a.users=b.users;a.display={show:"pupils"};a.show=function(c){a.display.show=c}};